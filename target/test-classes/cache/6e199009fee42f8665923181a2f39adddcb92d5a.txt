{"sha":"6e199009fee42f8665923181a2f39adddcb92d5a","commit":{"url":"https://api.github.com/repos/kingarj/API-migration-recommender/git/commits/6e199009fee42f8665923181a2f39adddcb92d5a","message":"add service to map results of searching github commits to an object"},"url":"https://api.github.com/repos/kingarj/API-migration-recommender/commits/6e199009fee42f8665923181a2f39adddcb92d5a","files":[{"sha":"85692fe58b982320c0dd775193a5017dfe0cc77e","filename":"src/main/java/controllers/Controller.java","status":"modified","additions":5,"changes":21,"patch":"@@ -1,40 +1,29 @@\n package controllers;\n \n import java.io.IOException;\n-import java.io.InputStreamReader;\n-import java.io.Reader;\n import java.net.URISyntaxException;\n-import java.nio.charset.Charset;\n \n-import org.apache.http.HttpEntity;\n import org.apache.http.HttpResponse;\n import org.apache.http.client.ClientProtocolException;\n import org.apache.http.client.methods.HttpGet;\n-import org.apache.http.entity.ContentType;\n-\n-import com.google.gson.Gson;\n-import com.google.gson.GsonBuilder;\n \n import domain.SearchCommitResponse;\n+import services.SearchCommitService;\n \n public class Controller {\n \n \tVersionControlGateway vcg;\n+\tSearchCommitService scs;\n \n \tpublic Controller() {\n \t\tthis.vcg \u003d new VersionControlGateway();\n+\t\tthis.scs \u003d new SearchCommitService();\n \t}\n \n-\tpublic String[] generateRecommendations(String source, String target)\n-\t\t\tthrows URISyntaxException, ClientProtocolException, IOException {\n+\tpublic String[] generateRecommendations(String source, String target) throws URISyntaxException, ClientProtocolException, IOException {\n \t\tHttpGet request \u003d vcg.buildSearchCommitRequestBody(source, target);\n \t\tHttpResponse response \u003d vcg.executeHttpRequest(request);\n-\t\tHttpEntity entity \u003d response.getEntity();\n-\t\tGson gson \u003d new GsonBuilder().create();\n-\t\tContentType contentType \u003d ContentType.getOrDefault(entity);\n-\t\tCharset charset \u003d contentType.getCharset();\n-\t\tReader reader \u003d new InputStreamReader(entity.getContent(), charset);\n-\t\tSearchCommitResponse searchCommitResponse \u003d gson.fromJson(reader, SearchCommitResponse.class);\n+\t\tSearchCommitResponse searchCommitResponse \u003d scs.createNewSearchCommitResponse(response);\n \t\treturn null;\n \t}\n "},{"sha":"458ec8151e6b88d3dfa5e50d041dbd8d23fd7298","filename":"src/main/java/domain/SearchCommitResponse.java","status":"modified","additions":2,"changes":3,"patch":"@@ -1,5 +1,6 @@\n package domain;\n \n public class SearchCommitResponse implements Response{\n-\tSearchCommit[] items;\n+\tpublic int total_count;\n+\tpublic SearchCommit[] items;\n }"},{"sha":"a3689b5c3a481281b933115c96e2e7bcdf623038","filename":"src/main/java/services/SearchCommitService.java","status":"added","additions":29,"changes":29,"patch":"@@ -0,0 +1,29 @@\n+package services;\n+\n+import java.io.IOException;\n+import java.io.InputStreamReader;\n+import java.io.Reader;\n+import java.nio.charset.Charset;\n+\n+import org.apache.http.HttpEntity;\n+import org.apache.http.HttpResponse;\n+import org.apache.http.entity.ContentType;\n+\n+import com.google.gson.Gson;\n+import com.google.gson.GsonBuilder;\n+\n+import domain.SearchCommitResponse;\n+\n+public class SearchCommitService {\n+\n+\tpublic SearchCommitResponse createNewSearchCommitResponse(HttpResponse response) throws UnsupportedOperationException, IOException {\n+\t\tHttpEntity entity \u003d response.getEntity();\n+\t\tGson gson \u003d new GsonBuilder().create();\n+\t\tContentType contentType \u003d ContentType.getOrDefault(entity);\n+\t\tCharset charset \u003d contentType.getCharset();\n+\t\tReader reader \u003d new InputStreamReader(entity.getContent(), charset);\n+\t\tSearchCommitResponse searchCommitResponse \u003d gson.fromJson(reader, SearchCommitResponse.class);\n+\t\treturn searchCommitResponse;\n+\t}\n+\n+}"},{"sha":"44229bcd80d7969ab43c02ed6542c4f51ec552b6","filename":"src/test/java/services/SearchCommitServiceTest.java","status":"added","additions":41,"changes":41,"patch":"@@ -0,0 +1,41 @@\n+package services;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertNotNull;\n+\n+import java.io.IOException;\n+\n+import org.apache.http.Consts;\n+import org.apache.http.HttpResponse;\n+import org.apache.http.HttpStatus;\n+import org.apache.http.HttpVersion;\n+import org.apache.http.entity.ContentType;\n+import org.apache.http.entity.StringEntity;\n+import org.apache.http.message.BasicHttpResponse;\n+import org.junit.Test;\n+\n+import domain.SearchCommitResponse;\n+\n+public class SearchCommitServiceTest {\n+\t\n+\tSearchCommitService searchCommitService \u003d new SearchCommitService();\n+\t\n+\t@Test\n+\tpublic void canInstantiateSearchCommitService() {\n+\t\tSearchCommitService searchCommitService \u003d new SearchCommitService();\n+\t\tassertNotNull(searchCommitService);\n+\t}\n+\t\n+\t@Test\n+\tpublic void canCreateNewSearchCommitResponse() throws UnsupportedOperationException, IOException {\n+\t\tStringEntity entity \u003d new StringEntity(\"{\\\"total_count\\\":0,\\\"incomplete_results\\\":false,\\\"items\\\":[]}\",\n+\t\t        ContentType.create(\"application/json\", Consts.UTF_8));\n+\t\tHttpResponse response \u003d new BasicHttpResponse(HttpVersion.HTTP_1_1, \n+\t\t\t    HttpStatus.SC_OK, \"OK\");\n+\t\tresponse.setEntity(entity);\n+\t\tSearchCommitResponse searchCommitResponse \u003d searchCommitService.createNewSearchCommitResponse(response);\n+\t\tassertNotNull(searchCommitResponse);\n+\t\tassertEquals(searchCommitResponse.items.length, 0);\n+\t\tassertEquals(searchCommitResponse.total_count, 0);\n+\t}\n+\n+}"},{"sha":"a8a9ceafd3d82013838ca1343a9e2c3a13abe5ab","filename":"target/classes/controllers/Controller.class","status":"modified","additions":0,"changes":0},{"sha":"6d21b6c7a5261de4752affa61eb2fb614a9e520e","filename":"target/classes/domain/SearchCommitResponse.class","status":"modified","additions":0,"changes":0},{"sha":"d567bb0ee8e4b676533d49e980af9dce83b36ab0","filename":"target/classes/services/SearchCommitService.class","status":"added","additions":0,"changes":0},{"sha":"693c041a927936c4a816c605394dd72d575ef53a","filename":"target/test-classes/services/SearchCommitServiceTest.class","status":"added","additions":0,"changes":0}]}